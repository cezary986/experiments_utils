<!-- STARTED -->
<ion-item class="block">
  <strong class="mr1">{{ "experiments.started" | translate }}</strong>
  {{ data.started | date: "yyyy.MM.dd HH:mm:ss" }}
</ion-item>

<!-- FINISHED -->
<ion-item>
  <strong class="mr1">{{ "experiments.finished" | translate }}</strong>
  <ng-container *ngIf="data.finished">
    {{ data.finished | date: "yyyy.MM.dd HH:mm:ss" }}
  </ng-container>
  <ng-container *ngIf="!data.finished">
    {{ "run.still_running" | translate }}
  </ng-container>
</ion-item>

<!-- STATUS -->
<ion-item>
  <strong class="mr1">{{ "run.status" | translate }}</strong>
  <app-status-dot
    class="mr2 block"
    [failed]="data.has_errors"
    [killed]="data.killed"
    [finished]="data.finished !== undefined && data.finished !== null"
    [neverRunned]="false"
  ></app-status-dot>
</ion-item>

<!-- STEPS -->
<ion-accordion-group>
  <ion-accordion *ngIf="steps">
    <ion-item slot="header">
      <strong class="mr1">{{ "run.steps" | translate }}</strong>
      {{ steps.length }}
    </ion-item>

    <ion-list class="p0" slot="content">
      <ion-item *ngFor="let step of steps">
        <span class="ml2">{{ step }}</span>
      </ion-item>
    </ion-list>
  </ion-accordion>
</ion-accordion-group>

<!-- NUMBER OF CONFIGS -->
<ion-item>
  <strong class="mr1">{{ "run.configs_number" | translate }}</strong>
  <ng-container *ngIf="data.number_of_configs">
    {{ data.number_of_configs }}
  </ng-container>
</ion-item>

<div class="mb2"></div>

<!-- FINISHED CONFIGS -->
<ion-accordion-group>
  <ion-accordion>
    <ion-item slot="header">
      <ion-label>
        <strong class="mr1">{{ "run.finished_configs" | translate }}</strong>
        <ng-container *ngIf="configsFinished">
          {{ configsFinished.length }}
        </ng-container>
      </ion-label>
    </ion-item>

    <ion-list class="p0" slot="content">
      <ion-item *ngFor="let item of configsFinished">
        <ion-label class="pl2">
          <div class="mb1">
            {{ item.config_name }}
          </div>

          <div class="finished-configs-info">
            {{ "experiments.finished" | translate }}
            {{ item.finished | date: "yyyy.MM.dd HH:mm:ss" }}
          </div>
          <div class="finished-configs-info">
            {{ "run.took" | translate }}
            <span *ngIf="item.took.days">
              {{ item.took.days }}{{ "run.days" | translate }}
            </span>
            <span *ngIf="item.took.hours"> {{ item.took.hours }}h </span>
            <span *ngIf="item.took.minutes"> {{ item.took.minutes }}min </span>
            <span *ngIf="item.took.seconds"> {{ item.took.seconds }}s </span>
          </div>
        </ion-label>
      </ion-item>
    </ion-list>
  </ion-accordion>
</ion-accordion-group>

<!-- FAILED CONFIGS -->
<ion-accordion-group>
  <ion-accordion>
    <ion-item slot="header">
      <ion-label>
        <strong class="mr1">{{ "run.failed_configs" | translate }}</strong>
        <ng-container *ngIf="configsFailed">
          {{ configsFailed.length }}
        </ng-container>
      </ion-label>
    </ion-item>

    <ion-list class="p0" slot="content">
      <ion-item *ngFor="let item of configsFailed">
        <ion-label class="pl2">
          <div class="mb1">
            {{ item.config_name }}
          </div>

          <div class="finished-configs-info">
            {{ "experiments.finished" | translate }}
            {{ item.finished | date: "yyyy.MM.dd HH:mm:ss" }}
          </div>
          <div *ngIf="item.took" class="finished-configs-info">
            {{ "run.took" | translate }}
            <span *ngIf="item.took.days">
              {{ item.took.days }}{{ "run.days" | translate }}
            </span>
            <span *ngIf="item.took.hours"> {{ item.took.hours }}h </span>
            <span *ngIf="item.took.minutes"> {{ item.took.minutes }}min </span>
            <span> {{ item.took.seconds }}s </span>
          </div>
          <div *ngIf="steps" class="finished-configs-info">
            {{ "run.failed_step" | translate }}
            <strong>{{ steps[item.current_step] }}</strong>

            <span class="ml1"
              >( {{ item.current_step + 1 }} / {{ steps.length }} )</span
            >
          </div>
          <div>
            <ion-button
              class="mb1"
              (click)="
                errorDetailesCollapsedFlags[item.config_name] =
                  errorDetailesCollapsedFlags[item.config_name] ? false : true
              "
              color="light"
              >{{ "run.toogle_error_message" | translate }}</ion-button
            >
            <div *ngIf="errorDetailesCollapsedFlags[item.config_name]">
              <div class="error-details bold">
                {{ item.error_message }}
              </div>
              <p class="mt1 error-details" *ngIf="item.stack_trace">
                {{ item.stack_trace }}
              </p>
            </div>
          </div>
        </ion-label>
      </ion-item>
    </ion-list>
  </ion-accordion>
</ion-accordion-group>

<!-- RUNNING CONFIGS -->
<ion-accordion-group>
  <ion-accordion>
    <ion-item slot="header">
      <ion-label>
        <strong class="mr1">{{ "run.running_configs" | translate }}</strong>
        <ng-container *ngIf="configsRunning">
          {{ configsRunning.length }}
        </ng-container>
      </ion-label>
    </ion-item>

    <ion-list class="p0" slot="content">
      <ion-item *ngFor="let item of configsRunning">
        <ion-label class="pl2">
          <div class="mb1">
            {{ item.config_name }}
          </div>
          <div *ngIf="item.took" class="finished-configs-info">
            {{ "run.took" | translate }}
            <span *ngIf="item.took.days">
              {{ item.took.days }}{{ "run.days" | translate }}
            </span>
            <span *ngIf="item.took.hours"> {{ item.took.hours }}h </span>
            <span *ngIf="item.took.minutes"> {{ item.took.minutes }}min </span>
            <span> {{ item.took.seconds }}s </span>
          </div>
          <div *ngIf="steps" class="finished-configs-info">
            {{ "run.current_step" | translate }}
            <strong>{{ steps[item.current_step] }}</strong>

            <span class="ml1"
              >( {{ item.current_step + 1 }} / {{ steps.length }} )</span
            >
          </div>
        </ion-label>
      </ion-item>
    </ion-list>
  </ion-accordion>
</ion-accordion-group>